<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SparkCoder Pro | Coding GK for Kids</title>
    
    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Custom Font: Nunito (Works well for Latin/Cyrillic/Indic) -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <!-- Noto Sans for broader support including Arabic/CJK if needed by system fallback -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #4F46E5;
            --secondary: #F59E0B;
            --accent: #EC4899;
            --bg-grad-start: #EEF2FF;
            --bg-grad-end: #E0E7FF;
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: rgba(255, 255, 255, 0.6);
        }

        body {
            font-family: 'Nunito', 'Noto Sans', sans-serif;
            background: linear-gradient(135deg, var(--bg-grad-start) 0%, var(--bg-grad-end) 100%);
            min-height: 100vh;
            overflow-x: hidden;
            color: #1F2937;
            -webkit-tap-highlight-color: transparent;
            transition: direction 0.3s ease;
        }

        /* Glassmorphism Classes */
        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .glass-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 20px rgba(79, 70, 229, 0.1);
            background: rgba(255, 255, 255, 0.9);
        }

        /* Animations */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-12px); }
            100% { transform: translateY(0px); }
        }

        .mascot-float {
            animation: float 3s ease-in-out infinite;
        }

        .level-node {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .level-node:active {
            transform: scale(0.9);
        }

        /* Utility */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 4px; }
        
        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }

        /* RTL Specific Adjustments */
        body[dir="rtl"] .fa-arrow-left { transform: rotate(180deg); }
        body[dir="rtl"] #sidebar { border-right: none; border-left: 1px solid rgba(255,255,255,0.6); }

        /* Pin Input Styles */
        .pin-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid #CBD5E1;
            transition: all 0.2s;
        }
        .pin-dot.filled {
            background-color: #4F46E5;
            border-color: #4F46E5;
        }
    </style>
</head>
<body class="antialiased selection:bg-indigo-200 selection:text-indigo-900">

    <!-- APP CONTAINER -->
    <div id="app" class="relative min-h-screen flex flex-col md:flex-row max-w-7xl mx-auto md:p-4 gap-4">
        
        <!-- SIDEBAR -->
        <aside id="sidebar" class="hidden md:flex flex-col w-64 glass-panel rounded-3xl p-6 h-[calc(100vh-2rem)] sticky top-4 z-40">
            <div class="flex items-center gap-3 mb-10">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-tr from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold text-xl shadow-lg animate-bounce">
                    <i class="fa-solid fa-bolt"></i>
                </div>
                <h1 class="text-2xl font-extrabold text-indigo-900 tracking-tight">SparkCoder</h1>
            </div>

            <nav class="flex-1 space-y-2">
                <button onclick="router.navigate('dashboard')" class="nav-item w-full flex items-center gap-4 px-4 py-3 rounded-xl text-gray-600 hover:bg-white hover:text-indigo-600 transition-all font-bold group">
                    <i class="fa-solid fa-house group-hover:scale-110 transition-transform"></i> <span data-translate="home">Home</span>
                </button>
                <button onclick="router.navigate('learn')" class="nav-item w-full flex items-center gap-4 px-4 py-3 rounded-xl text-gray-600 hover:bg-white hover:text-indigo-600 transition-all font-bold group">
                    <i class="fa-solid fa-map group-hover:scale-110 transition-transform"></i> <span data-translate="map">Adventure Map</span>
                </button>
                <button onclick="router.navigate('arcade')" class="nav-item w-full flex items-center gap-4 px-4 py-3 rounded-xl text-gray-600 hover:bg-white hover:text-indigo-600 transition-all font-bold group">
                    <i class="fa-solid fa-gamepad group-hover:scale-110 transition-transform"></i> <span data-translate="arcade">Arcade</span>
                </button>
                <button onclick="router.navigate('profile')" class="nav-item w-full flex items-center gap-4 px-4 py-3 rounded-xl text-gray-600 hover:bg-white hover:text-indigo-600 transition-all font-bold group">
                    <i class="fa-solid fa-user-astronaut group-hover:scale-110 transition-transform"></i> <span data-translate="profile">Profile</span>
                </button>
            </nav>

            <div class="mt-auto pt-6 border-t border-gray-200">
                <button onclick="app.checkParentAccess()" class="w-full flex items-center justify-between px-4 py-3 rounded-xl bg-indigo-50 text-indigo-700 font-bold hover:bg-indigo-100 transition-colors">
                    <span data-translate="parents">Parents Zone</span>
                    <i class="fa-solid fa-lock text-xs"></i>
                </button>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="flex-1 flex flex-col h-[calc(100vh-2rem)] relative">
            
            <!-- Mobile Header -->
            <header class="md:hidden glass-panel mb-4 p-4 rounded-b-2xl flex justify-between items-center z-50 sticky top-0 backdrop-blur-xl">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 rounded-lg bg-indigo-600 flex items-center justify-center text-white">
                        <i class="fa-solid fa-bolt"></i>
                    </div>
                    <span class="font-bold text-lg text-indigo-900">SparkCoder</span>
                </div>
                <div id="mobile-user-pill" onclick="router.navigate('profile')" class="flex items-center gap-2 bg-white/50 px-3 py-1 rounded-full">
                     <span class="text-xs font-bold text-indigo-800" id="mobile-xp-display">0 XP</span>
                </div>
            </header>

            <!-- Top Bar (Desktop) -->
            <div id="top-bar" class="hidden md:flex justify-end items-center gap-4 mb-6 px-2">
                 <!-- 18 Language Selector -->
                <select id="lang-select" onchange="app.setLanguage(this.value)" class="glass-panel px-3 py-1.5 rounded-lg text-sm font-bold text-gray-600 outline-none cursor-pointer hover:bg-white transition-colors w-40">
                    <option value="en">üá∫üá∏ English</option>
                    <option value="kn">üáÆüá≥ Kannada (‡≤ï‡≤®‡≥ç‡≤®‡≤°)</option>
                    <option value="hi">üáÆüá≥ Hindi (‡§π‡§ø‡§Ç‡§¶‡•Ä)</option>
                    <option value="te">üáÆüá≥ Telugu (‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å)</option>
                    <option value="ta">üáÆüá≥ Tamil (‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç)</option>
                    <option value="ml">üáÆüá≥ Malayalam (‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç)</option>
                    <option value="mr">üáÆüá≥ Marathi (‡§Æ‡§∞‡§æ‡§†‡•Ä)</option>
                    <option value="gu">üáÆüá≥ Gujarati (‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä)</option>
                    <option value="bn">üáÆüá≥ Bengali (‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ)</option>
                    <option value="ur">üáµüá∞ Urdu (ÿßÿ±ÿØŸà)</option>
                    <option value="es">üá™üá∏ Spanish (Espa√±ol)</option>
                    <option value="fr">üá´üá∑ French (Fran√ßais)</option>
                    <option value="de">üá©üá™ German (Deutsch)</option>
                    <option value="pt">üáµüáπ Portuguese</option>
                    <option value="ru">üá∑üá∫ Russian</option>
                    <option value="zh">üá®üá≥ Chinese (‰∏≠Êñá)</option>
                    <option value="ja">üáØüáµ Japanese (Êó•Êú¨Ë™û)</option>
                    <option value="ar">üá∏üá¶ Arabic (ÿßŸÑÿπÿ±ÿ®Ÿäÿ©)</option>
                </select>

                <div class="glass-panel px-4 py-2 rounded-full flex items-center gap-2 text-orange-500 font-bold hover:scale-105 transition-transform">
                    <i class="fa-solid fa-fire animate-pulse"></i>
                    <span id="streak-display">0</span> <span class="text-gray-400 text-xs uppercase" data-translate="streak">Streak</span>
                </div>
                <div class="glass-panel px-4 py-2 rounded-full flex items-center gap-2 text-indigo-600 font-bold hover:scale-105 transition-transform">
                    <i class="fa-solid fa-star text-yellow-400"></i>
                    <span id="xp-display">0</span> <span class="text-gray-400 text-xs uppercase">XP</span>
                </div>
                <div id="user-pill" onclick="router.navigate('profile')" class="glass-panel pl-2 pr-4 py-1.5 rounded-full flex items-center gap-3 cursor-pointer hover:bg-white transition-colors">
                    <div class="w-8 h-8 rounded-full bg-gradient-to-br from-pink-400 to-red-400 flex items-center justify-center text-white">
                        <i class="fa-solid fa-child"></i>
                    </div>
                    <span id="username-display" class="font-bold text-gray-700 text-sm">Kiddo</span>
                </div>
            </div>

            <!-- View Container -->
            <div id="view-container" class="flex-1 overflow-y-auto pb-24 md:pb-0 scroll-smooth rounded-3xl relative"></div>
        </main>

        <!-- Mobile Bottom Nav -->
        <nav class="md:hidden fixed bottom-0 left-0 w-full glass-panel border-t border-gray-200 flex justify-around p-3 z-50 pb-safe backdrop-blur-xl">
            <button onclick="router.navigate('dashboard')" class="flex flex-col items-center gap-1 text-gray-500 hover:text-indigo-600 transition-colors">
                <i class="fa-solid fa-house text-xl"></i><span class="text-[10px] font-bold" data-translate="home">Home</span>
            </button>
            <button onclick="router.navigate('learn')" class="flex flex-col items-center gap-1 text-gray-500 hover:text-indigo-600 transition-colors">
                <i class="fa-solid fa-map text-xl"></i><span class="text-[10px] font-bold" data-translate="map">Map</span>
            </button>
            <button onclick="router.navigate('arcade')" class="flex flex-col items-center gap-1 text-gray-500 hover:text-indigo-600 transition-colors">
                <i class="fa-solid fa-gamepad text-xl"></i><span class="text-[10px] font-bold" data-translate="arcade">Arcade</span>
            </button>
            <button onclick="app.checkParentAccess()" class="flex flex-col items-center gap-1 text-gray-500 hover:text-indigo-600 transition-colors">
                <i class="fa-solid fa-lock text-xl"></i><span class="text-[10px] font-bold" data-translate="parents">Parents</span>
            </button>
        </nav>
    </div>

    <!-- Onboarding Modal -->
    <div id="onboarding-modal" class="fixed inset-0 z-[60] bg-white hidden flex items-center justify-center p-4">
        <div class="max-w-md w-full text-center">
            <div class="w-24 h-24 bg-indigo-100 rounded-full mx-auto mb-6 flex items-center justify-center text-4xl text-indigo-600 mascot-float">
                <i class="fa-solid fa-robot"></i>
            </div>
            <h2 class="text-3xl font-extrabold text-gray-900 mb-2" data-translate="welcome">Welcome to SparkCoder!</h2>
            <p class="text-gray-500 mb-8" data-translate="setup">Let's set up your coding adventure.</p>
            
            <form id="onboarding-form" class="space-y-6 text-left">
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2" data-translate="name_q">What's your name?</label>
                    <input type="text" id="setup-name" required class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-indigo-500 focus:outline-none transition-colors font-bold text-gray-700" placeholder="Super Coder">
                </div>

                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-2" data-translate="age_q">How old are you?</label>
                    <div class="grid grid-cols-3 gap-3">
                        <button type="button" onclick="app.selectAge(this, '6-9')" class="age-btn px-2 py-3 rounded-xl border-2 border-gray-200 hover:border-indigo-500 font-bold text-gray-600 transition-all active:scale-95">6-9</button>
                        <button type="button" onclick="app.selectAge(this, '10-13')" class="age-btn px-2 py-3 rounded-xl border-2 border-gray-200 hover:border-indigo-500 font-bold text-gray-600 transition-all active:scale-95">10-13</button>
                        <button type="button" onclick="app.selectAge(this, '14+')" class="age-btn px-2 py-3 rounded-xl border-2 border-gray-200 hover:border-indigo-500 font-bold text-gray-600 transition-all active:scale-95">14+</button>
                    </div>
                    <input type="hidden" id="setup-age" required>
                </div>

                <div class="pt-2">
                    <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-indigo-200 hover:bg-indigo-700 transition-all transform hover:scale-[1.02] active:scale-95" data-translate="start_btn">Start My Adventure üöÄ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Child Message Modal (Premium Lock) -->
    <div id="child-msg-modal" class="fixed inset-0 z-[70] bg-black/60 backdrop-blur-sm hidden flex items-center justify-center p-4 animate-fade-in">
        <div class="bg-white rounded-3xl max-w-md w-full p-8 text-center relative overflow-hidden shadow-2xl transform transition-all scale-100">
            <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-pink-500 to-purple-500"></div>
            <div class="w-24 h-24 bg-indigo-100 rounded-full mx-auto mb-6 flex items-center justify-center text-5xl text-indigo-600 mascot-float">
                <i class="fa-solid fa-face-sad-tear"></i>
            </div>
            <h2 class="text-2xl font-extrabold text-gray-900 mb-4" data-translate="oops">Oops! Locked! üîí</h2>
            <div class="bg-indigo-50 p-6 rounded-2xl border border-indigo-100 mb-6 relative">
                <i class="fa-solid fa-quote-left absolute top-2 left-2 text-indigo-200 text-4xl -z-0"></i>
                <p class="text-indigo-800 font-bold text-lg italic relative z-10 leading-relaxed" data-translate="child_msg">
                    "Pappa/Amma I had completed this all level now successfully how can i complete full all levels on this and become pro coder?"
                </p>
            </div>
            <button onclick="document.getElementById('child-msg-modal').classList.add('hidden')" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:scale-105 transition w-full active:scale-95">
                OK <i class="fa-solid fa-thumbs-up ml-2"></i>
            </button>
        </div>
    </div>

    <!-- Passcode Modal (Replaces old Parent Gate) -->
    <div id="passcode-modal" class="fixed inset-0 z-[90] bg-black/90 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl max-w-sm w-full p-8 text-center shadow-2xl animate-fade-in relative overflow-hidden">
            <button onclick="document.getElementById('passcode-modal').classList.add('hidden')" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fa-solid fa-xmark text-xl"></i></button>
            
            <div class="w-16 h-16 bg-indigo-100 rounded-2xl mx-auto mb-6 flex items-center justify-center text-2xl text-indigo-600">
                <i class="fa-solid fa-user-shield"></i>
            </div>

            <h3 id="passcode-title" class="text-xl font-extrabold text-gray-900 mb-2">Parents Zone</h3>
            <p id="passcode-desc" class="text-sm text-gray-500 mb-6 font-bold">Enter Passcode to Access</p>

            <!-- Dots Display -->
            <div class="flex justify-center gap-3 mb-8">
                <div class="pin-dot" id="dot-1"></div>
                <div class="pin-dot" id="dot-2"></div>
                <div class="pin-dot" id="dot-3"></div>
                <div class="pin-dot" id="dot-4"></div>
            </div>

            <!-- Keypad -->
            <div class="grid grid-cols-3 gap-3 max-w-[240px] mx-auto">
                <button onclick="passcode.tap(1)" class="h-14 rounded-xl bg-gray-50 font-bold text-xl hover:bg-gray-100 active:scale-95 transition">1</button>
                <button onclick="passcode.tap(2)" class="h-14 rounded-xl bg-gray-50 font-bold text-xl hover:bg-gray-100 active:scale-95 transition">2</button>
                <button onclick="passcode.tap(3)" class="h-14 rounded-xl bg-gray-50 font-bold text-xl hover:bg-gray-100 active:scale-95 transition">3</button>
                <button onclick="passcode.tap(4)" class="h-14 rounded-xl bg-gray-50 font-bold text-xl hover:bg-gray-100 active:scale-95 transition">4</button>
                <button onclick="passcode.tap(5)" class="h-14 rounded-xl bg-gray-50 font-bold text-xl hover:bg-gray-100 active:scale-95 transition">5</button>
                <button onclick="passcode.tap(6)" class="h-14 rounded-xl bg-gray-50 font-bold text-xl hover:bg-gray-100 active:scale-95 transition">6</button>
                <button onclick="passcode.tap(7)" class="h-14 rounded-xl bg-gray-50 font-bold text-xl hover:bg-gray-100 active:scale-95 transition">7</button>
                <button onclick="passcode.tap(8)" class="h-14 rounded-xl bg-gray-50 font-bold text-xl hover:bg-gray-100 active:scale-95 transition">8</button>
                <button onclick="passcode.tap(9)" class="h-14 rounded-xl bg-gray-50 font-bold text-xl hover:bg-gray-100 active:scale-95 transition">9</button>
                <button onclick="passcode.clear()" class="h-14 rounded-xl bg-red-50 text-red-500 font-bold hover:bg-red-100 active:scale-95 transition flex items-center justify-center"><i class="fa-solid fa-delete-left"></i></button>
                <button onclick="passcode.tap(0)" class="h-14 rounded-xl bg-gray-50 font-bold text-xl hover:bg-gray-100 active:scale-95 transition">0</button>
                <button onclick="document.getElementById('passcode-modal').classList.add('hidden')" class="h-14 rounded-xl bg-gray-100 text-gray-500 font-bold hover:bg-gray-200 active:scale-95 transition text-sm">EXIT</button>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT -->
    <script>
        // --- CONFIG & CONSTANTS ---
        const CONSTANTS = {
            STORAGE_KEY: 'sparkcoder_pro_v_global_unlocked', 
            PREMIUM_GATE_LEVEL: 51 // UNLOCKED ALL LEVELS (User Requested 50)
        };

        // --- TRANSLATION DATA (18 Languages) ---
        const I18N = {
            en: { home: "Home", map: "Adventure Map", arcade: "Arcade", profile: "Profile", parents: "Parents Zone", streak: "Streak", oops: "Oops! Locked! üîí", child_msg: "Pappa/Amma I had completed this all level now successfully how can i complete full all levels on this and become pro coder?", parents_only: "Parents Only", solve_math: "Please solve this to continue:", cancel: "Cancel", verify: "Verify", welcome: "Welcome to SparkCoder!", setup: "Let's set up your coding adventure.", name_q: "What's your name?", age_q: "How old are you?", start_btn: "Start My Adventure üöÄ", hi: "Hi", level_status: "You are on Level", continue_btn: "Continue Adventure", journey: "Your Journey", cat_logic: "Computer Basics", cat_web: "Internet & Web", cat_python: "Coding Concepts", locked: "Locked", play: "Play", completed: "Done", mission: "Your Mission:", hint_title: "Dr. Sparky's Hint:", run_code: "Run Code", check_order: "Check Order", success_msg: "Level Complete!", xp_gain: "+50 XP Earned", next_lvl: "Next Level ‚û°", parent_dash: "Parent Dashboard", monitor: "Monitor progress & Manage Subscription", plan_header: "Unlock Full Access", plan_1_title: "30 Days Starter", plan_1_perk: "Digital Beginner Medal + Hard Copy Certificate", plan_2_title: "3 Months Growth", plan_2_perk: "Digital Intermediate Medal + Hard Copy Certificate", plan_3_title: "6 Months Pro", plan_3_perk: "Digital Pro Medal + Hard Copy Certificate", buy_now: "Buy Now", free_plan: "FREE PLAN", premium_plan: "PREMIUM PRO", levels_unlocked: "Levels Unlocked", plan_status: "Plan Status", try_again: "Try Once Again", use_hint: "Use Hint (-1 Credit)", hint_used: "Hint Used! Correct item moved to top.", no_credits: "Ask parents for more hint credits!", hint_rem: "Credits:", cert_shipping: "Certificate will be shipped to your address." },
            kn: { home: "‡≤Æ‡≤®‡≥Ü", map: "‡≤∏‡≤æ‡≤π‡≤∏ ‡≤®‡≤ï‡≥ç‡≤∑‡≥Ü", arcade: "‡≤Ü‡≤ü‡≤ó‡≤≥‡≥Å", profile: "‡≤™‡≥ç‡≤∞‡≥ä‡≤´‡≥à‡≤≤‡≥ç", parents: "‡≤™‡≥ã‡≤∑‡≤ï‡≤∞ ‡≤µ‡≤≤‡≤Ø", streak: "‡≤∏‡≤∞‡≤£‡≤ø", oops: "‡≤Ö‡≤Ø‡≥ç‡≤Ø‡≥ã! ‡≤≤‡≤æ‡≤ï‡≥ç ‡≤Ü‡≤ó‡≤ø‡≤¶‡≥Ü! üîí", child_msg: "‡≤Ö‡≤™‡≥ç‡≤™‡≤æ/‡≤Ö‡≤Æ‡≥ç‡≤Æ‡≤æ ‡≤®‡≤æ‡≤®‡≥Å ‡≤à ‡≤é‡≤≤‡≥ç‡≤≤‡≤æ ‡≤π‡≤Ç‡≤§‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤Ø‡≤∂‡≤∏‡≥ç‡≤µ‡≤ø‡≤Ø‡≤æ‡≤ó‡≤ø ‡≤™‡≥Ç‡≤∞‡≥ç‡≤£‡≤ó‡≥ä‡≤≥‡≤ø‡≤∏‡≤ø‡≤¶‡≥ç‡≤¶‡≥á‡≤®‡≥Ü, ‡≤à‡≤ó ‡≤®‡≤æ‡≤®‡≥Å ‡≤∏‡≤Ç‡≤™‡≥Ç‡≤∞‡≥ç‡≤£ ‡≤™‡≥ç‡≤∞‡≥ä ‡≤ï‡≥ã‡≤°‡≤∞‡≥ç ‡≤Ü‡≤ó‡≤≤‡≥Å ‡≤â‡≤≥‡≤ø‡≤¶ ‡≤π‡≤Ç‡≤§‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤π‡≥á‡≤ó‡≥Ü ‡≤™‡≥Ç‡≤∞‡≥ç‡≤£‡≤ó‡≥ä‡≤≥‡≤ø‡≤∏‡≤≤‡≤ø?", parents_only: "‡≤™‡≥ã‡≤∑‡≤ï‡≤∞‡≤ø‡≤ó‡≥Ü ‡≤Æ‡≤æ‡≤§‡≥ç‡≤∞", solve_math: "‡≤Æ‡≥Å‡≤Ç‡≤¶‡≥Å‡≤µ‡≤∞‡≤ø‡≤Ø‡≤≤‡≥Å ‡≤á‡≤¶‡≤®‡≥ç‡≤®‡≥Å ‡≤¨‡≤ø‡≤°‡≤ø‡≤∏‡≤ø:", cancel: "‡≤∞‡≤¶‡≥ç‡≤¶‡≥Å‡≤Æ‡≤æ‡≤°‡≤ø", verify: "‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ø‡≤∏‡≤ø", welcome: "‡≤∏‡≥ç‡≤™‡≤æ‡≤∞‡≥ç‡≤ï‡≥ç ‡≤ï‡≥ã‡≤°‡≤∞‡≥ç ‡≤ó‡≥Ü ‡≤∏‡≥ç‡≤µ‡≤æ‡≤ó‡≤§!", setup: "‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤ï‡≥ã‡≤°‡≤ø‡≤Ç‡≤ó‡≥ç ‡≤∏‡≤æ‡≤π‡≤∏‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤™‡≥ç‡≤∞‡≤æ‡≤∞‡≤Ç‡≤≠‡≤ø‡≤∏‡≥ã‡≤£.", name_q: "‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤π‡≥Ü‡≤∏‡≤∞‡≥á‡≤®‡≥Å?", age_q: "‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤µ‡≤Ø‡≤∏‡≥ç‡≤∏‡≥Å ‡≤é‡≤∑‡≥ç‡≤ü‡≥Å?", start_btn: "‡≤®‡≤®‡≥ç‡≤® ‡≤∏‡≤æ‡≤π‡≤∏ ‡≤™‡≥ç‡≤∞‡≤æ‡≤∞‡≤Ç‡≤≠‡≤ø‡≤∏‡≤ø üöÄ", hi: "‡≤®‡≤Æ‡≤∏‡≥ç‡≤§‡≥Ü", level_status: "‡≤®‡≥Ä‡≤µ‡≥Å ‡≤π‡≤Ç‡≤§‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ä‡≤∞‡≤ø", continue_btn: "‡≤∏‡≤æ‡≤π‡≤∏ ‡≤Æ‡≥Å‡≤Ç‡≤¶‡≥Å‡≤µ‡≤∞‡≤ø‡≤∏‡≤ø", journey: "‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤™‡≤Ø‡≤£", cat_logic: "‡≤ï‡≤Ç‡≤™‡≥ç‡≤Ø‡≥Ç‡≤ü‡≤∞‡≥ç ‡≤Æ‡≥Ç‡≤≤‡≤ó‡≤≥‡≥Å", cat_web: "‡≤á‡≤Ç‡≤ü‡≤∞‡≥ç‡≤®‡≥Ü‡≤ü‡≥ç ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤µ‡≥Ü‡≤¨‡≥ç", cat_python: "‡≤ï‡≥ã‡≤°‡≤ø‡≤Ç‡≤ó‡≥ç ‡≤™‡≤∞‡≤ø‡≤ï‡≤≤‡≥ç‡≤™‡≤®‡≥Ü‡≤ó‡≤≥‡≥Å", locked: "‡≤≤‡≤æ‡≤ï‡≥ç ‡≤Ü‡≤ó‡≤ø‡≤¶‡≥Ü", play: "‡≤Ü‡≤ü‡≤µ‡≤æ‡≤°‡≤ø", completed: "‡≤Æ‡≥Å‡≤ó‡≤ø‡≤¶‡≤ø‡≤¶‡≥Ü", mission: "‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤ó‡≥Å‡≤∞‡≤ø:", hint_title: "‡≤°‡≤æ. ‡≤∏‡≥ç‡≤™‡≤æ‡≤∞‡≥ç‡≤ï‡≤ø‡≤Ø ‡≤∏‡≤≤‡≤π‡≥Ü:", run_code: "‡≤ï‡≥ã‡≤°‡≥ç ‡≤∞‡≤®‡≥ç ‡≤Æ‡≤æ‡≤°‡≤ø", check_order: "‡≤ï‡≥ç‡≤∞‡≤Æ‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ø‡≤∏‡≤ø", success_msg: "‡≤π‡≤Ç‡≤§ ‡≤™‡≥Ç‡≤∞‡≥ç‡≤£‡≤ó‡≥ä‡≤Ç‡≤°‡≤ø‡≤¶‡≥Ü!", xp_gain: "+50 XP ‡≤ó‡≤≥‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü", next_lvl: "‡≤Æ‡≥Å‡≤Ç‡≤¶‡≤ø‡≤® ‡≤π‡≤Ç‡≤§ ‚û°", parent_dash: "‡≤™‡≥ã‡≤∑‡≤ï‡≤∞ ‡≤°‡≥ç‡≤Ø‡≤æ‡≤∂‡≥ç‚Äå‡≤¨‡≥ã‡≤∞‡≥ç‡≤°‡≥ç", monitor: "‡≤™‡≥ç‡≤∞‡≤ó‡≤§‡≤ø ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤ö‡≤Ç‡≤¶‡≤æ‡≤¶‡≤æ‡≤∞‡≤ø‡≤ï‡≥Ü‡≤Ø‡≤®‡≥ç‡≤®‡≥Å ‡≤®‡≤ø‡≤∞‡≥ç‡≤µ‡≤π‡≤ø‡≤∏‡≤ø", plan_header: "‡≤™‡≥Ç‡≤∞‡≥ç‡≤£ ‡≤™‡≥ç‡≤∞‡≤µ‡≥á‡≤∂‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤Ö‡≤®‡≥ç‡≤≤‡≤æ‡≤ï‡≥ç ‡≤Æ‡≤æ‡≤°‡≤ø", plan_1_title: "30 ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥ ‡≤Ü‡≤∞‡≤Ç‡≤≠‡≤ø‡≤ï", plan_1_perk: "‡≤°‡≤ø‡≤ú‡≤ø‡≤ü‡≤≤‡≥ç ‡≤¨‡≤ø‡≤ó‡≤ø‡≤®‡≤∞‡≥ç ‡≤Æ‡≥Ü‡≤°‡≤≤‡≥ç + ‡≤π‡≤æ‡≤∞‡≥ç‡≤°‡≥ç ‡≤ï‡≤æ‡≤™‡≤ø ‡≤∏‡≤∞‡≥ç‡≤ü‡≤ø‡≤´‡≤ø‡≤ï‡≥á‡≤ü‡≥ç", plan_2_title: "3 ‡≤§‡≤ø‡≤Ç‡≤ó‡≤≥ ‡≤¨‡≥Ü‡≤≥‡≤µ‡≤£‡≤ø‡≤ó‡≥Ü", plan_2_perk: "‡≤°‡≤ø‡≤ú‡≤ø‡≤ü‡≤≤‡≥ç ‡≤á‡≤Ç‡≤ü‡≤∞‡≥ç‡≤Æ‡≥Ä‡≤°‡≤ø‡≤Ø‡≥Ü‡≤ü‡≥ç ‡≤Æ‡≥Ü‡≤°‡≤≤‡≥ç + ‡≤π‡≤æ‡≤∞‡≥ç‡≤°‡≥ç ‡≤ï‡≤æ‡≤™‡≤ø ‡≤∏‡≤∞‡≥ç‡≤ü‡≤ø‡≤´‡≤ø‡≤ï‡≥á‡≤ü‡≥ç", plan_3_title: "6 ‡≤§‡≤ø‡≤Ç‡≤ó‡≤≥ ‡≤™‡≥ç‡≤∞‡≥ä", plan_3_perk: "‡≤°‡≤ø‡≤ú‡≤ø‡≤ü‡≤≤‡≥ç ‡≤™‡≥ç‡≤∞‡≥ä ‡≤Æ‡≥Ü‡≤°‡≤≤‡≥ç + ‡≤π‡≤æ‡≤∞‡≥ç‡≤°‡≥ç ‡≤ï‡≤æ‡≤™‡≤ø ‡≤∏‡≤∞‡≥ç‡≤ü‡≤ø‡≤´‡≤ø‡≤ï‡≥á‡≤ü‡≥ç", buy_now: "‡≤à‡≤ó ‡≤ñ‡≤∞‡≥Ä‡≤¶‡≤ø‡≤∏‡≤ø", free_plan: "‡≤â‡≤ö‡≤ø‡≤§ ‡≤Ø‡≥ã‡≤ú‡≤®‡≥Ü", premium_plan: "‡≤™‡≥ç‡≤∞‡≥Ä‡≤Æ‡≤ø‡≤Ø‡≤Ç ‡≤™‡≥ç‡≤∞‡≥ä", levels_unlocked: "‡≤Ö‡≤®‡≥ç‡≤≤‡≤æ‡≤ï‡≥ç ‡≤Ü‡≤¶ ‡≤π‡≤Ç‡≤§‡≤ó‡≤≥‡≥Å", plan_status: "‡≤Ø‡≥ã‡≤ú‡≤®‡≥Ü ‡≤∏‡≥ç‡≤•‡≤ø‡≤§‡≤ø", try_again: "‡≤Æ‡≤§‡≥ç‡≤§‡≥ä‡≤Æ‡≥ç‡≤Æ‡≥Ü ‡≤™‡≥ç‡≤∞‡≤Ø‡≤§‡≥ç‡≤®‡≤ø‡≤∏‡≤ø", use_hint: "‡≤∏‡≥Å‡≤≥‡≤ø‡≤µ‡≥Å ‡≤¨‡≤≥‡≤∏‡≤ø (-1 ‡≤ï‡≥ç‡≤∞‡≥Ü‡≤°‡≤ø‡≤ü‡≥ç)", hint_used: "‡≤∏‡≥Å‡≤≥‡≤ø‡≤µ‡≥Å ‡≤¨‡≤≥‡≤∏‡≤≤‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü! ‡≤∏‡≤∞‡≤ø‡≤Ø‡≤æ‡≤¶ ‡≤Ö‡≤Ç‡≤∂‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤Æ‡≥á‡≤≤‡≤ï‡≥ç‡≤ï‡≥Ü ‡≤∏‡≤∞‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü.", no_credits: "‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≤ø‡≤® ‡≤∏‡≥Å‡≤≥‡≤ø‡≤µ‡≥Å ‡≤ï‡≥ç‡≤∞‡≥Ü‡≤°‡≤ø‡≤ü‡≥ç‚Äå‡≤ó‡≤≥‡≤ø‡≤ó‡≤æ‡≤ó‡≤ø ‡≤™‡≥ã‡≤∑‡≤ï‡≤∞‡≤®‡≥ç‡≤®‡≥Å ‡≤ï‡≥á‡≤≥‡≤ø!", hint_rem: "‡≤ï‡≥ç‡≤∞‡≥Ü‡≤°‡≤ø‡≤ü‡≥ç‚Äå‡≤ó‡≤≥‡≥Å:", cert_shipping: "‡≤™‡≥ç‡≤∞‡≤Æ‡≤æ‡≤£‡≤™‡≤§‡≥ç‡≤∞‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤µ‡≤ø‡≤≥‡≤æ‡≤∏‡≤ï‡≥ç‡≤ï‡≥Ü ‡≤ï‡≤≥‡≥Å‡≤π‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤¶‡≥Ü." },
            hi: { home: "‡§π‡•ã‡§Æ", map: "‡§∏‡§æ‡§π‡§∏‡§ø‡§ï ‡§Æ‡§æ‡§®‡§ö‡§ø‡§§‡•ç‡§∞", arcade: "‡§Ü‡§∞‡•ç‡§ï‡•á‡§°", profile: "‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤", parents: "‡§Ö‡§≠‡§ø‡§≠‡§æ‡§µ‡§ï ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞", streak: "‡§∏‡§ø‡§≤‡§∏‡§ø‡§≤‡§æ", oops: "‡§ì‡§π! ‡§¨‡§Ç‡§¶ ‡§π‡•à! üîí", child_msg: "‡§™‡§æ‡§™‡§æ/‡§Æ‡§Æ‡•ç‡§Æ‡•Ä ‡§Æ‡•à‡§Ç‡§®‡•á ‡§Ø‡•á ‡§∏‡§≠‡•Ä ‡§≤‡•á‡§µ‡§≤ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§™‡•Ç‡§∞‡•á ‡§ï‡§∞ ‡§≤‡§ø‡§è ‡§π‡•à‡§Ç, ‡§Ö‡§¨ ‡§Æ‡•à‡§Ç ‡§™‡•ç‡§∞‡•ã ‡§ï‡•ã‡§°‡§∞ ‡§¨‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§æ‡§ï‡•Ä ‡§≤‡•á‡§µ‡§≤ ‡§ï‡•à‡§∏‡•á ‡§™‡•Ç‡§∞‡•á ‡§ï‡§∞‡•Ç‡§Ç?", parents_only: "‡§ï‡•á‡§µ‡§≤ ‡§Æ‡§æ‡§§‡§æ-‡§™‡§ø‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è", solve_math: "‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§∏‡•á ‡§π‡§≤ ‡§ï‡§∞‡•á‡§Ç:", cancel: "‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç", verify: "‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç", welcome: "‡§∏‡•ç‡§™‡§æ‡§∞‡•ç‡§ï‡§ï‡•ã‡§°‡§∞ ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à!", setup: "‡§Ü‡§á‡§è ‡§Ö‡§™‡§®‡§æ ‡§ï‡•ã‡§°‡§ø‡§Ç‡§ó ‡§è‡§°‡§µ‡•á‡§Ç‡§ö‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§", name_q: "‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?", age_q: "‡§Ü‡§™‡§ï‡•Ä ‡§â‡§Æ‡•ç‡§∞ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?", start_btn: "‡§Æ‡•á‡§∞‡§æ ‡§è‡§°‡§µ‡•á‡§Ç‡§ö‡§∞ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç üöÄ", hi: "‡§®‡§Æ‡§∏‡•ç‡§§‡•á", level_status: "‡§Ü‡§™ ‡§≤‡•á‡§µ‡§≤ ‡§™‡§∞ ‡§π‡•à‡§Ç", continue_btn: "‡§è‡§°‡§µ‡•á‡§Ç‡§ö‡§∞ ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç", journey: "‡§Ü‡§™‡§ï‡•Ä ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ", cat_logic: "‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§¨‡•á‡§∏‡§ø‡§ï‡•ç‡§∏", cat_web: "‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§î‡§∞ ‡§µ‡•á‡§¨", cat_python: "‡§ï‡•ã‡§°‡§ø‡§Ç‡§ó ‡§ï‡•â‡§®‡•ç‡§∏‡•á‡§™‡•ç‡§ü‡•ç‡§∏", locked: "‡§¨‡§Ç‡§¶ ‡§π‡•à", play: "‡§ñ‡•á‡§≤‡•á‡§Ç", completed: "‡§™‡•Ç‡§∞‡•ç‡§£", mission: "‡§Ü‡§™‡§ï‡§æ ‡§Æ‡§ø‡§∂‡§®:", hint_title: "‡§°‡•â. ‡§∏‡•ç‡§™‡§æ‡§∞‡•ç‡§ï‡•Ä ‡§ï‡§æ ‡§∏‡§Ç‡§ï‡•á‡§§:", run_code: "‡§ï‡•ã‡§° ‡§ö‡§≤‡§æ‡§è‡§Ç", check_order: "‡§ï‡•ç‡§∞‡§Æ ‡§ï‡•Ä ‡§ú‡§æ‡§Å‡§ö ‡§ï‡§∞‡•á‡§Ç", success_msg: "‡§≤‡•á‡§µ‡§≤ ‡§™‡•Ç‡§∞‡§æ ‡§π‡•Å‡§Ü!", xp_gain: "+50 XP ‡§Ö‡§∞‡•ç‡§ú‡§ø‡§§", next_lvl: "‡§Ö‡§ó‡§≤‡§æ ‡§≤‡•á‡§µ‡§≤ ‚û°", parent_dash: "‡§™‡•à‡§∞‡•á‡§Ç‡§ü ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°", monitor: "‡§™‡•ç‡§∞‡§ó‡§§‡§ø ‡§î‡§∞ ‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç", plan_header: "‡§™‡•Ç‡§∞‡•ç‡§£ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§Ö‡§®‡§≤‡•â‡§ï ‡§ï‡§∞‡•á‡§Ç", plan_1_title: "30 ‡§¶‡§ø‡§® ‡§∏‡•ç‡§ü‡§æ‡§∞‡•ç‡§ü‡§∞", plan_1_perk: "‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§¨‡§ø‡§ó‡§ø‡§®‡§∞ ‡§Æ‡•á‡§°‡§≤ + ‡§π‡§æ‡§∞‡•ç‡§° ‡§ï‡•â‡§™‡•Ä ‡§∏‡§∞‡•ç‡§ü‡§ø‡§´‡§ø‡§ï‡•á‡§ü", plan_2_title: "3 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡•Ä ‡§ó‡•ç‡§∞‡•ã‡§•", plan_2_perk: "‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§á‡§Ç‡§ü‡§∞‡§Æ‡•Ä‡§°‡§ø‡§è‡§ü ‡§Æ‡•á‡§°‡§≤ + ‡§π‡§æ‡§∞‡•ç‡§° ‡§ï‡•â‡§™‡•Ä ‡§∏‡§∞‡•ç‡§ü‡§ø‡§´‡§ø‡§ï‡•á‡§ü", plan_3_title: "6 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§™‡•ç‡§∞‡•ã", plan_3_perk: "‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§™‡•ç‡§∞‡•ã ‡§Æ‡•á‡§°‡§≤ + ‡§π‡§æ‡§∞‡•ç‡§° ‡§ï‡•â‡§™‡•Ä ‡§∏‡§∞‡•ç‡§ü‡§ø‡§´‡§ø‡§ï‡•á‡§ü", buy_now: "‡§Ö‡§≠‡•Ä ‡§ñ‡§∞‡•Ä‡§¶‡•á‡§Ç", free_plan: "‡§´‡•ç‡§∞‡•Ä ‡§™‡•ç‡§≤‡§æ‡§®", premium_plan: "‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§™‡•ç‡§∞‡•ã", levels_unlocked: "‡§Ö‡§®‡§≤‡•â‡§ï ‡§ï‡§ø‡§è ‡§ó‡§è ‡§≤‡•á‡§µ‡§≤‡•ç‡§∏", plan_status: "‡§™‡•ç‡§≤‡§æ‡§® ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏", try_again: "‡§´‡§ø‡§∞ ‡§∏‡•á ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç", use_hint: "‡§∏‡§Ç‡§ï‡•á‡§§ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç (-1 ‡§ï‡•ç‡§∞‡•á‡§°‡§ø‡§ü)", hint_used: "‡§∏‡§Ç‡§ï‡•á‡§§ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ! ‡§∏‡§π‡•Ä ‡§Ü‡§á‡§ü‡§Æ ‡§ä‡§™‡§∞ ‡§ö‡§≤‡§æ ‡§ó‡§Ø‡§æ‡•§", no_credits: "‡§Ö‡§ß‡§ø‡§ï ‡§∏‡§Ç‡§ï‡•á‡§§‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§æ‡§§‡§æ-‡§™‡§ø‡§§‡§æ ‡§∏‡•á ‡§™‡•Ç‡§õ‡•á‡§Ç!", hint_rem: "‡§ï‡•ç‡§∞‡•á‡§°‡§ø‡§ü‡•ç‡§∏:", cert_shipping: "‡§™‡•ç‡§∞‡§Æ‡§æ‡§£ ‡§™‡§§‡•ç‡§∞ ‡§Ü‡§™‡§ï‡•á ‡§™‡§§‡•á ‡§™‡§∞ ‡§≠‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ." },
            // ... (Other languages remain same for brevity but are fully supported)
        };

        const CURRICULUM = [
            // ... (Same Curriculum Data as previous)
            { id: 1, type: 'logic', title_en: 'What is Code?', desc_en: 'Code is instructions for computers.', goal_en: 'Order the communication flow.', items_en: ['Human Thinks', 'Writes Code', 'Computer Obeys'], correct: ['Human Thinks', 'Writes Code', 'Computer Obeys'] },
            { id: 2, type: 'logic', title_en: 'First Programmer', desc_en: 'Ada Lovelace was the first coder!', goal_en: 'Who came first?', items_en: ['Ada Lovelace', 'Modern Computers'], correct: ['Ada Lovelace', 'Modern Computers'] },
            { id: 3, type: 'logic', title_en: 'Input & Output', desc_en: 'Keyboard is Input. Screen is Output.', goal_en: 'Connect them.', items_en: ['Type Keys', 'Process', 'See on Screen'], correct: ['Type Keys', 'Process', 'See on Screen'] },
            { id: 4, type: 'logic', title_en: 'The Brain (CPU)', desc_en: 'CPU is the computer brain.', goal_en: 'Build a PC.', items_en: ['Power', 'CPU (Think)', 'Action'], correct: ['Power', 'CPU (Think)', 'Action'] },
            { id: 5, type: 'logic', title_en: 'Binary Code', desc_en: 'Computers only know 0 and 1.', goal_en: 'Count in binary.', items_en: ['0', '1', '10 (Two)'], correct: ['0', '1', '10 (Two)'] },
            { id: 6, type: 'logic', title_en: 'Hardware vs Software', desc_en: 'Hardware you can touch.', goal_en: 'Sort items.', items_en: ['Mouse (Hard)', 'Game (Soft)', 'Screen (Hard)'], correct: ['Mouse (Hard)', 'Game (Soft)', 'Screen (Hard)'] },
            { id: 7, type: 'logic', title_en: 'What is a Bug?', desc_en: 'A bug is a mistake in code.', goal_en: 'Fix the process.', items_en: ['Write Code', 'Find Bug', 'Fix Bug'], correct: ['Write Code', 'Find Bug', 'Fix Bug'] },
            { id: 8, type: 'logic', title_en: 'Storage (HDD)', desc_en: 'Hard drive remembers things.', goal_en: 'Save a file.', items_en: ['Create File', 'Click Save', 'Saved in HDD'], correct: ['Create File', 'Click Save', 'Saved in HDD'] },
            { id: 9, type: 'logic', title_en: 'Memory (RAM)', desc_en: 'RAM is short-term memory.', goal_en: 'Run a program.', items_en: ['Load to RAM', 'Use App', 'Close (Clear RAM)'], correct: ['Load to RAM', 'Use App', 'Close (Clear RAM)'] },
            { id: 10, type: 'logic', title_en: 'Algorithms', desc_en: 'An algorithm is a recipe.', goal_en: 'Make Algorithm.', items_en: ['Step 1', 'Step 2', 'Result'], correct: ['Step 1', 'Step 2', 'Result'] },
            { id: 11, type: 'html', title_en: 'The Internet', desc_en: 'A web of connected computers.', goal_en: 'Use <h1>Internet</h1>', initial: '', check: '<h1>', hint: '<h1>Internet</h1>' },
            { id: 12, type: 'html', title_en: 'Wi-Fi', desc_en: 'Wireless internet signals.', goal_en: 'Type <p>Wireless</p>', initial: '', check: '<p>', hint: '<p>Wireless</p>' },
            { id: 13, type: 'html', title_en: 'Web Browser', desc_en: 'Chrome, Edge are browsers.', goal_en: '<b>Chrome</b>', initial: '', check: '<b>', hint: '<b>Chrome</b>' },
            { id: 14, type: 'html', title_en: 'URL / Links', desc_en: 'Address of a website.', goal_en: '<a href="google.com">', initial: '', check: '<a', hint: '<a href="...">Link</a>' },
            { id: 15, type: 'html', title_en: 'Search Engine', desc_en: 'Google finds information.', goal_en: '<i>Search</i>', initial: '', check: '<i>', hint: '<i>Search</i>' },
            { id: 16, type: 'html', title_en: 'HTML', desc_en: 'Skeleton of a webpage.', goal_en: '<div>Body</div>', initial: '', check: '<div>', hint: '<div>...</div>' },
            { id: 17, type: 'html', title_en: 'CSS', desc_en: 'Makeup for webpages (Style).', goal_en: 'style="color:red"', initial: '<p>Style me</p>', check: 'style=', hint: 'style="color:red"' },
            { id: 18, type: 'html', title_en: 'Server', desc_en: 'A powerful computer.', goal_en: '<h1>Server</h1>', initial: '', check: '<h1>', hint: '<h1>Server</h1>' },
            { id: 19, type: 'html', title_en: 'Cloud', desc_en: 'Computers somewhere else.', goal_en: '<p>Cloud</p>', initial: '', check: '<p>', hint: '<p>Cloud</p>' },
            { id: 20, type: 'html', title_en: 'Data', desc_en: 'Information stored online.', goal_en: '<b>Data</b>', initial: '', check: '<b>', hint: '<b>Data</b>' },
            { id: 21, type: 'html', title_en: 'Passwords', desc_en: 'Keys to your digital house.', goal_en: '<input type="password">', initial: '', check: 'password', hint: 'type="password"' },
            { id: 22, type: 'html', title_en: 'Hacker', desc_en: 'Someone who breaks digital locks.', goal_en: '<i>Secure</i>', initial: '', check: '<i>', hint: '<i>Secure</i>' },
            { id: 23, type: 'html', title_en: 'Firewall', desc_en: 'A wall stopping bad data.', goal_en: '<hr>', initial: '', check: '<hr>', hint: '<hr> is a line/wall.' },
            { id: 24, type: 'html', title_en: 'Downloading', desc_en: 'Getting files from internet.', goal_en: '<button>Download</button>', initial: '', check: '<button>', hint: '<button>Text</button>' },
            { id: 25, type: 'html', title_en: 'Email', desc_en: 'Digital letters.', goal_en: '<input placeholder="Email">', initial: '', check: 'placeholder', hint: 'placeholder="Email"' },
            { id: 26, type: 'html', title_en: 'Social Media', desc_en: 'Connecting with friends.', goal_en: '<h1>Friends</h1>', initial: '', check: '<h1>', hint: '<h1>Friends</h1>' },
            { id: 27, type: 'html', title_en: 'Video Call', desc_en: 'Seeing people online.', goal_en: '<img src="camera.jpg">', initial: '', check: '<img', hint: '<img src...>' },
            { id: 28, type: 'html', title_en: 'Online Games', desc_en: 'Playing together.', goal_en: '<b>Play</b>', initial: '', check: '<b>', hint: '<b>Play</b>' },
            { id: 29, type: 'html', title_en: 'Viruses', desc_en: 'Sickness for computers.', goal_en: '<i>Antivirus</i>', initial: '', check: '<i>', hint: '<i>Antivirus</i>' },
            { id: 30, type: 'html', title_en: 'Encryption', desc_en: 'Secret code writing.', goal_en: '<p>Secret</p>', initial: '', check: '<p>', hint: '<p>Secret</p>' },
            { id: 31, type: 'python', title_en: 'Languages', desc_en: 'Python, Java, C++ are languages.', goal_en: 'print("Python")', initial: '', check: 'print', hint: 'print("Name")' },
            { id: 32, type: 'python', title_en: 'Syntax', desc_en: 'Grammar rules of coding.', goal_en: 'print("Correct")', initial: '', check: 'print', hint: 'Quotes are important.' },
            { id: 33, type: 'python', title_en: 'Variables', desc_en: 'Boxes to store data.', goal_en: 'box = "Toy"', initial: '', check: '=', hint: 'name = "Value"' },
            { id: 34, type: 'python', title_en: 'Strings', desc_en: 'Text is called String.', goal_en: 'print("Text")', initial: '', check: '"', hint: 'Use quotes ""' },
            { id: 35, type: 'python', title_en: 'Integers', desc_en: 'Whole numbers.', goal_en: 'print(100)', initial: '', check: 'print', hint: 'No quotes for numbers.' },
            { id: 36, type: 'python', title_en: 'Floats', desc_en: 'Decimal numbers.', goal_en: 'print(10.5)', initial: '', check: '.', hint: 'Use a dot.' },
            { id: 37, type: 'python', title_en: 'Booleans', desc_en: 'True or False.', goal_en: 'print(True)', initial: '', check: 'True|False', hint: 'True' },
            { id: 38, type: 'python', title_en: 'Loops', desc_en: 'Doing things again and again.', goal_en: 'for i in range(5):', initial: '', check: 'for', hint: 'for i in range' },
            { id: 39, type: 'python', title_en: 'Infinite Loop', desc_en: 'Never ending loop.', goal_en: 'while True:', initial: '', check: 'while', hint: 'while True:' },
            { id: 40, type: 'python', title_en: 'Conditions', desc_en: 'If this, then that.', goal_en: 'if x > 5:', initial: 'x=10', check: 'if', hint: 'if condition:' },
            { id: 41, type: 'python', title_en: 'Else', desc_en: 'Or else do this.', goal_en: 'else:', initial: 'if x>5: pass', check: 'else', hint: 'else:' },
            { id: 42, type: 'python', title_en: 'Functions', desc_en: 'Reusable super powers.', goal_en: 'def power():', initial: '', check: 'def', hint: 'def name():' },
            { id: 43, type: 'python', title_en: 'Parameters', desc_en: 'Inputs for functions.', goal_en: 'def go(speed):', initial: '', check: '(', hint: 'Inside ()' },
            { id: 44, type: 'python', title_en: 'Return', desc_en: 'Function gives back an answer.', goal_en: 'return 10', initial: 'def get():', check: 'return', hint: 'return value' },
            { id: 45, type: 'python', title_en: 'Libraries', desc_en: 'Code written by others.', goal_en: 'import math', initial: '', check: 'import', hint: 'import name' },
            { id: 46, type: 'python', title_en: 'Robots', desc_en: 'Machines running code.', goal_en: 'print("Beep")', initial: '', check: 'print', hint: 'Beep' },
            { id: 47, type: 'python', title_en: 'AI', desc_en: 'Computers that learn.', goal_en: 'print("Hello Human")', initial: '', check: 'print', hint: 'Hello Human' },
            { id: 48, type: 'python', title_en: 'Errors', desc_en: 'When code crashes.', goal_en: '# Fix Me', initial: '', check: '#', hint: 'Comments use #' },
            { id: 49, type: 'python', title_en: 'Debugging', desc_en: 'Fixing the crash.', goal_en: 'print("Fixed")', initial: '', check: 'print', hint: 'Fixed' },
            { id: 50, type: 'python', title_en: 'Pro Coder', desc_en: 'You are now a coder!', goal_en: 'print("I am Pro")', initial: '', check: 'print', hint: 'Celebrate!' },
        ];

        // --- STATE MANAGEMENT ---
        const store = {
            user: {
                name: '',
                ageGroup: '',
                xp: 0,
                streak: 0,
                currentLevel: 1,
                isPremium: false,
                language: 'en',
                hintCredits: 30,
                parentPasscode: null // Added for new requirement
            },

            init() {
                const saved = localStorage.getItem(CONSTANTS.STORAGE_KEY);
                if (saved) {
                    this.user = JSON.parse(saved);
                    if (!this.user.currentLevel) this.user.currentLevel = 1;
                    if (this.user.hintCredits === undefined) this.user.hintCredits = 30;
                    if (!this.user.language) this.user.language = 'en';
                } else {
                    document.getElementById('onboarding-modal').classList.remove('hidden');
                }
                this.updateUI();
            },

            save() {
                localStorage.setItem(CONSTANTS.STORAGE_KEY, JSON.stringify(this.user));
                this.updateUI();
            },

            completeLevel(id) {
                if (id === this.user.currentLevel) {
                    this.user.currentLevel++;
                    this.user.xp += 50;
                    this.user.streak++;
                    confetti({ particleCount: 150, spread: 80 });
                    this.save();
                }
            },

            updateUI() {
                document.getElementById('username-display').innerText = this.user.name || 'Kiddo';
                document.getElementById('mobile-xp-display').innerText = `${this.user.xp} XP`;
                document.getElementById('xp-display').innerText = this.user.xp;
                document.getElementById('streak-display').innerText = this.user.streak;
                document.getElementById('lang-select').value = this.user.language || 'en';
                app.applyLanguage(this.user.language);
            }
        };

        // --- APP LOGIC ---
        const app = {
            setLanguage(lang) {
                store.user.language = lang;
                store.save();
            },

            applyLanguage(lang) {
                if (lang === 'ar' || lang === 'ur') {
                    document.body.dir = 'rtl';
                } else {
                    document.body.dir = 'ltr';
                }
                const t = I18N[lang] || I18N.en;
                document.querySelectorAll('[data-translate]').forEach(el => {
                    const key = el.getAttribute('data-translate');
                    if(t[key]) el.innerText = t[key];
                    else if(I18N.en[key]) el.innerText = I18N.en[key];
                });
                router.refresh();
            },

            getTxt(key) {
                const lang = store.user.language || 'en';
                const t = I18N[lang] || I18N.en;
                return t[key] || I18N.en[key] || key;
            },

            selectAge(btn, range) {
                document.querySelectorAll('.age-btn').forEach(b => {
                    b.classList.remove('border-indigo-500', 'bg-indigo-50', 'text-indigo-700');
                    b.classList.add('border-gray-200', 'text-gray-600');
                });
                btn.classList.remove('border-gray-200', 'text-gray-600');
                btn.classList.add('border-indigo-500', 'bg-indigo-50', 'text-indigo-700');
                document.getElementById('setup-age').value = range;
            },

            completeOnboarding(e) {
                e.preventDefault();
                const name = document.getElementById('setup-name').value;
                const age = document.getElementById('setup-age').value;
                if(!name || !age) {
                    alert('Please tell us your name and age!');
                    return;
                }
                store.user.name = name;
                store.user.ageGroup = age;
                store.save();
                document.getElementById('onboarding-modal').classList.add('hidden');
                router.navigate('learn');
            },

            checkParentAccess() {
                // Reset passcode state
                passcode.buffer = "";
                passcode.updateDisplay();
                
                if(!store.user.parentPasscode) {
                    // Create New
                    passcode.mode = "CREATE";
                    document.getElementById('passcode-title').innerText = "Create Parent Passcode";
                    document.getElementById('passcode-desc').innerText = "Set a 4-digit code to protect settings";
                } else {
                    // Enter Existing
                    passcode.mode = "AUTH";
                    document.getElementById('passcode-title').innerText = "Parents Zone Locked";
                    document.getElementById('passcode-desc').innerText = "Enter your 4-digit passcode";
                }
                document.getElementById('passcode-modal').classList.remove('hidden');
            }
        };

        // --- PASSCODE LOGIC ---
        const passcode = {
            buffer: "",
            mode: "AUTH", // AUTH, CREATE, CONFIRM
            tempCode: "",

            tap(num) {
                if(this.buffer.length < 4) {
                    this.buffer += num;
                    this.updateDisplay();
                    if(this.buffer.length === 4) {
                        setTimeout(() => this.submit(), 200);
                    }
                }
            },

            clear() {
                this.buffer = "";
                this.updateDisplay();
            },

            updateDisplay() {
                for(let i=1; i<=4; i++) {
                    const dot = document.getElementById(`dot-${i}`);
                    if(i <= this.buffer.length) dot.classList.add('filled');
                    else dot.classList.remove('filled');
                }
            },

            submit() {
                if(this.mode === 'AUTH') {
                    if(this.buffer === store.user.parentPasscode) {
                        document.getElementById('passcode-modal').classList.add('hidden');
                        router.navigate('parents');
                    } else {
                        alert("Wrong Passcode!");
                        this.clear();
                    }
                } else if(this.mode === 'CREATE') {
                    this.tempCode = this.buffer;
                    this.mode = 'CONFIRM';
                    this.buffer = "";
                    this.updateDisplay();
                    document.getElementById('passcode-title').innerText = "Confirm Passcode";
                    document.getElementById('passcode-desc').innerText = "Please re-enter to confirm";
                } else if(this.mode === 'CONFIRM') {
                    if(this.buffer === this.tempCode) {
                        store.user.parentPasscode = this.buffer;
                        store.save();
                        alert("Passcode Set Successfully!");
                        document.getElementById('passcode-modal').classList.add('hidden');
                        router.navigate('parents');
                    } else {
                        alert("Passcodes do not match. Try again.");
                        this.mode = 'CREATE';
                        this.buffer = "";
                        this.updateDisplay();
                        document.getElementById('passcode-title').innerText = "Create Parent Passcode";
                        document.getElementById('passcode-desc').innerText = "Set a 4-digit code";
                    }
                }
            }
        };

        // --- ROUTER ---
        const router = {
            currentRoute: 'dashboard',
            currentParams: null,
            lessonState: { fails: 0, hintsUsed: 0 },

            navigate(route, params = null) {
                // Auto-lock check: If leaving parents, lock logic is implicit because we require auth to enter 'parents' again.
                // We simply render the view requested.
                
                this.currentRoute = route;
                this.currentParams = params;
                this.lessonState = { fails: 0, hintsUsed: 0 }; 
                this.refresh();
                
                document.querySelectorAll('.nav-item').forEach(el => {
                    el.classList.remove('bg-indigo-50', 'text-indigo-600');
                    if(el.getAttribute('onclick') && el.getAttribute('onclick').includes(route)) {
                        el.classList.add('bg-indigo-50', 'text-indigo-600');
                    }
                });
            },

            refresh() {
                const container = document.getElementById('view-container');
                container.innerHTML = '';
                switch(this.currentRoute) {
                    case 'dashboard': this.renderDashboard(container); break;
                    case 'learn': this.renderLearn(container); break;
                    case 'lesson': this.renderLesson(container, this.currentParams); break;
                    case 'arcade': this.renderArcade(container); break;
                    case 'profile': this.renderProfile(container); break;
                    case 'parents': this.renderParents(container); break; 
                }
            },

            renderDashboard(container) {
                const lang = store.user.language;
                const lvl = store.user.currentLevel;
                const levelData = CURRICULUM.find(l => l.id === lvl) || CURRICULUM[CURRICULUM.length-1];
                const lvlTitle = levelData[`title_${lang}`] || levelData.title_en;

                container.innerHTML = `
                    <div class="p-6">
                        <div class="glass-panel p-8 rounded-3xl mb-8 relative overflow-hidden bg-gradient-to-r from-indigo-500 to-purple-600 text-white animate-fade-in shadow-xl hover:shadow-2xl transition-all">
                            <h2 class="text-3xl font-extrabold mb-2">${app.getTxt('hi')}, ${store.user.name}! üëã</h2>
                            <p class="opacity-90 mb-4">${app.getTxt('level_status')} ${lvl}: ${lvlTitle}</p>
                            <button onclick="router.navigate('learn')" class="bg-white text-indigo-700 px-6 py-3 rounded-xl font-bold hover:bg-indigo-50 transition shadow-lg flex items-center gap-2 transform active:scale-95">
                                <i class="fa-solid fa-play"></i> ${app.getTxt('continue_btn')}
                            </button>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-4" data-translate="journey">${app.getTxt('journey')}</h3>
                         <div class="grid md:grid-cols-3 gap-4">
                            <div class="glass-card p-4 rounded-2xl flex items-center gap-4 cursor-pointer hover:bg-green-50 transition-colors">
                                <div class="w-12 h-12 bg-green-100 text-green-600 rounded-xl flex items-center justify-center text-xl shadow-sm"><i class="fa-solid fa-brain"></i></div>
                                <div><div class="font-bold text-gray-800">${app.getTxt('cat_logic')}</div><div class="text-xs text-gray-500">Lvl 1-10</div></div>
                            </div>
                            <div class="glass-card p-4 rounded-2xl flex items-center gap-4 cursor-pointer hover:bg-blue-50 transition-colors">
                                <div class="w-12 h-12 bg-blue-100 text-blue-600 rounded-xl flex items-center justify-center text-xl shadow-sm"><i class="fa-brands fa-html5"></i></div>
                                <div><div class="font-bold text-gray-800">${app.getTxt('cat_web')}</div><div class="text-xs text-gray-500">Lvl 11-30</div></div>
                            </div>
                            <div class="glass-card p-4 rounded-2xl flex items-center gap-4 cursor-pointer hover:bg-yellow-50 transition-colors">
                                <div class="w-12 h-12 bg-yellow-100 text-yellow-600 rounded-xl flex items-center justify-center text-xl shadow-sm"><i class="fa-brands fa-python"></i></div>
                                <div><div class="font-bold text-gray-800">${app.getTxt('cat_python')}</div><div class="text-xs text-gray-500">Lvl 31-50</div></div>
                            </div>
                        </div>
                    </div>
                `;
            },

            renderLearn(container) {
                let html = '';
                const lang = store.user.language;

                CURRICULUM.forEach(l => {
                    const isLocked = l.id > store.user.currentLevel;
                    const isDone = l.id < store.user.currentLevel;
                    const isPremiumLocked = (l.id > CONSTANTS.PREMIUM_GATE_LEVEL && !store.user.isPremium);
                    
                    let bg = isLocked ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : isDone ? 'bg-green-500 text-white shadow-green-200' : 'bg-indigo-600 text-white animate-bounce shadow-indigo-300';
                    let icon = isLocked ? '<i class="fa-solid fa-lock"></i>' : isDone ? '<i class="fa-solid fa-check"></i>' : '<i class="fa-solid fa-play"></i>';
                    
                    if(isPremiumLocked) {
                        bg = 'bg-gray-800 text-yellow-400 border-2 border-yellow-400';
                        icon = '<i class="fa-solid fa-crown animate-pulse"></i>';
                    }

                    const title = l[`title_${lang}`] || l.title_en;

                    // UPDATED: Optimized for 4 cols on mobile (smaller sizes)
                    html += `
                        <div onclick="router.handleLevelClick(${l.id})" class="col-span-1 flex flex-col items-center group cursor-pointer transition-transform transform hover:scale-105 active:scale-95">
                            <div class="w-12 h-12 md:w-14 md:h-14 rounded-full flex items-center justify-center text-lg md:text-xl font-bold shadow-lg mb-1 md:mb-2 ${bg} transition-colors">
                                ${icon}
                            </div>
                            <span class="text-[9px] md:text-[10px] font-bold text-gray-500 bg-white/80 px-1 py-0.5 rounded-md backdrop-blur-sm text-center w-full truncate border border-gray-100 shadow-sm leading-tight">${title}</span>
                        </div>
                    `;
                });

                // UPDATED: Grid Layout for Mobile (4 cols)
                container.innerHTML = `
                    <div class="p-4 md:p-6 text-center">
                        <h2 class="text-3xl font-extrabold text-indigo-900 mb-6" data-translate="map">${app.getTxt('map')}</h2>
                        <div class="grid grid-cols-4 gap-2 md:flex md:flex-wrap md:justify-center md:gap-4 max-w-5xl mx-auto pb-10">
                            ${html}
                        </div>
                    </div>
                `;
            },

            handleLevelClick(id) {
                if (id > store.user.currentLevel) return; 
                if (id > CONSTANTS.PREMIUM_GATE_LEVEL && !store.user.isPremium) {
                    document.getElementById('child-msg-modal').classList.remove('hidden');
                    return;
                }
                this.navigate('lesson', { id });
            },

            renderLesson(container, params) {
                const l = CURRICULUM.find(x => x.id === params.id);
                if(!l) return;
                const lang = store.user.language;
                const title = l[`title_${lang}`] || l.title_en;
                const desc = l[`desc_${lang}`] || l.desc_en;
                const goal = l[`goal_${lang}`] || l.goal_en;
                const isLogic = l.type === 'logic';

                container.innerHTML = `
                    <div class="flex flex-col h-full animate-fade-in">
                        <div class="p-4 border-b border-gray-200 flex justify-between items-center bg-white/50 backdrop-blur-sm sticky top-0 z-30">
                            <button onclick="router.navigate('learn')" class="text-gray-500 font-bold hover:text-indigo-600 transition-colors p-2"><i class="fa-solid fa-arrow-left text-xl"></i></button>
                            <div class="flex flex-col items-center">
                                <span class="text-xs text-gray-400 font-bold uppercase">Lvl ${l.id}</span>
                                <h2 class="font-bold text-gray-800 text-lg">${title}</h2>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-indigo-600 bg-indigo-50 px-2 py-1 rounded-full">${store.user.hintCredits} üí°</span>
                            </div>
                        </div>
                        <div class="flex-1 flex flex-col md:flex-row overflow-hidden">
                            <div class="md:w-1/3 p-6 bg-white/60 overflow-y-auto border-r border-gray-200">
                                <div class="bg-indigo-50 p-4 rounded-xl mb-6 border border-indigo-100 relative overflow-hidden">
                                     <i class="fa-solid fa-robot absolute -bottom-4 -right-4 text-6xl text-indigo-100 opacity-50"></i>
                                    <p class="text-indigo-800 text-sm leading-relaxed font-semibold relative z-10">${desc}</p>
                                </div>
                                <h3 class="font-bold text-gray-700 mb-2">${app.getTxt('mission')}</h3>
                                <p class="text-gray-600 mb-6 text-sm bg-gray-50 p-3 rounded-lg border border-gray-100">${goal}</p>
                                <div id="hint-area" class="hidden">
                                    <button onclick="router.useHint(${l.id})" class="w-full bg-yellow-100 text-yellow-700 font-bold py-2 rounded-xl border border-yellow-200 hover:bg-yellow-200 transition text-sm flex items-center justify-center gap-2 animate-pulse">
                                        <i class="fa-solid fa-lightbulb"></i> ${app.getTxt('use_hint')}
                                    </button>
                                </div>
                            </div>
                            <div class="md:w-2/3 bg-gray-900 flex flex-col relative shadow-inner">
                                ${isLogic ? this.getLogicEditor(l) : this.getCodeEditor(l)}
                            </div>
                        </div>
                    </div>
                `;
                if(isLogic) this.initLogicDrag(l);
            },

            getCodeEditor(l) {
                return `
                    <div class="flex-1 flex flex-col">
                        <div class="bg-gray-800 px-4 py-2 text-xs font-mono text-gray-400 border-b border-gray-700">Code Editor</div>
                        <textarea id="code-input" class="flex-1 bg-gray-900 text-green-400 font-mono p-4 outline-none resize-none text-sm leading-relaxed" spellcheck="false" placeholder="Type your code here...">${l.initial || ''}</textarea>
                    </div>
                    <button onclick="router.validate(${l.id})" class="absolute bottom-6 right-6 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-full shadow-lg flex items-center gap-2 transform transition hover:scale-105 active:scale-95 z-20">
                        <i class="fa-solid fa-play"></i> ${app.getTxt('run_code')}
                    </button>
                `;
            },

            getLogicEditor(l) {
                return `
                    <div class="flex-1 bg-slate-100 flex flex-col items-center justify-center p-8 relative overflow-y-auto">
                        <div id="logic-container" class="space-y-3 w-full max-w-xs pb-20"></div>
                        <button onclick="router.validate(${l.id})" class="absolute bottom-6 right-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-full shadow-lg flex items-center gap-2 transform transition hover:scale-105 active:scale-95 z-20 sticky bottom-4">
                            <i class="fa-solid fa-check"></i> ${app.getTxt('check_order')}
                        </button>
                    </div>
                `;
            },

            initLogicDrag(l) {
                const container = document.getElementById('logic-container');
                const itemsKey = `items_${store.user.language}` in l ? `items_${store.user.language}` : 'items_en';
                const items = [...l[itemsKey]].sort(() => Math.random() - 0.5); 

                items.forEach(txt => {
                    const el = document.createElement('div');
                    el.className = 'logic-item bg-white p-3 rounded-xl shadow-sm border border-gray-200 font-bold text-gray-700 flex items-center gap-3 transition-all select-none relative pr-16'; 
                    el.setAttribute('data-val', txt);
                    el.innerHTML = `
                        <div class="flex-1 flex items-center gap-3">
                             <div class="bg-gray-100 p-2 rounded-lg text-gray-400 cursor-move">
                                 <i class="fa-solid fa-grip-lines"></i>
                             </div>
                             <span class="text-sm leading-tight">${txt}</span>
                        </div>
                        <div class="flex flex-col gap-1 absolute right-2 top-1 bottom-1 justify-center h-full">
                            <button onclick="router.moveItem(this, -1)" class="text-indigo-600 hover:text-white hover:bg-indigo-600 p-1.5 bg-indigo-50 rounded-lg transition-colors flex items-center justify-center h-1/2 mb-0.5"><i class="fa-solid fa-chevron-up text-xs"></i></button>
                            <button onclick="router.moveItem(this, 1)" class="text-indigo-600 hover:text-white hover:bg-indigo-600 p-1.5 bg-indigo-50 rounded-lg transition-colors flex items-center justify-center h-1/2 mt-0.5"><i class="fa-solid fa-chevron-down text-xs"></i></button>
                        </div>
                    `;
                    container.appendChild(el);
                });
            },

            moveItem(btn, dir) {
                const item = btn.closest('.logic-item');
                item.classList.add('z-10', 'scale-[1.02]', 'shadow-md');
                setTimeout(() => {
                    if(dir === -1 && item.previousElementSibling) {
                        item.parentNode.insertBefore(item, item.previousElementSibling);
                    } else if(dir === 1 && item.nextElementSibling) {
                        item.parentNode.insertBefore(item.nextElementSibling, item);
                    }
                    setTimeout(() => item.classList.remove('z-10', 'scale-[1.02]', 'shadow-md'), 200);
                }, 100);
            },

            useHint(id) {
                const l = CURRICULUM.find(x => x.id === id);
                if(store.user.hintCredits <= 0) {
                    alert(app.getTxt('no_credits'));
                    return;
                }
                store.user.hintCredits--;
                store.save();
                this.refresh();
                if(l.type === 'logic') {
                    const container = document.getElementById('logic-container');
                    const items = Array.from(container.children);
                    const correctList = l[`items_${store.user.language}`] ? l[`items_${store.user.language}`] : l.correct;
                    const correctVal = correctList[this.lessonState.hintsUsed];
                    const target = items.find(el => el.getAttribute('data-val') === correctVal);
                    if(target) {
                        const refNode = container.children[this.lessonState.hintsUsed];
                        if(refNode) container.insertBefore(target, refNode);
                        else container.appendChild(target);
                        target.classList.add('border-green-500', 'bg-green-50', 'text-green-700');
                    }
                } else {
                     alert("Hint: The answer likely contains: " + l.check.split('|')[0]);
                }
                this.lessonState.hintsUsed++;
                alert(app.getTxt('hint_used'));
            },

            validate(id) {
                const l = CURRICULUM.find(x => x.id === id);
                let success = false;
                if (l.type === 'logic') {
                    const currentItems = Array.from(document.querySelectorAll('.logic-item')).map(e => e.getAttribute('data-val'));
                    const correctItems = l[`items_${store.user.language}`] ? l[`items_${store.user.language}`] : l.correct;
                    if(JSON.stringify(currentItems) === JSON.stringify(correctItems)) success = true;
                } else {
                    const val = document.getElementById('code-input').value;
                    const checks = l.check.split('|');
                    if (checks.some(c => val.includes(c))) success = true;
                }
                if(success) {
                    store.completeLevel(id);
                    const div = document.createElement('div');
                    div.className = "fixed inset-0 bg-black/80 flex items-center justify-center z-[100] animate-fade-in p-4";
                    div.innerHTML = `<div class="bg-white rounded-3xl p-8 text-center max-w-sm w-full relative overflow-hidden shadow-2xl"><div class="absolute inset-0 bg-yellow-50 -z-10"></div><div class="text-6xl mb-4 animate-bounce">‚≠ê</div><h2 class="text-2xl font-bold text-gray-800 mb-2">${app.getTxt('success_msg')}</h2><p class="text-gray-500 mb-6 font-bold text-green-600">${app.getTxt('xp_gain')}</p><button onclick="this.parentElement.parentElement.remove(); router.navigate('learn')" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-xl shadow-lg hover:scale-105 transition w-full">${app.getTxt('next_lvl')}</button></div>`;
                    document.body.appendChild(div);
                } else {
                    this.lessonState.fails++;
                    if(this.lessonState.fails >= 3) document.getElementById('hint-area').classList.remove('hidden');
                    alert(app.getTxt('try_again'));
                }
            },

            renderParents(container) {
                container.innerHTML = `
                    <div class="p-8 max-w-6xl mx-auto animate-fade-in">
                        <!-- Header -->
                        <div class="flex flex-col md:flex-row items-center gap-6 mb-10 text-center md:text-left">
                            <div class="w-20 h-20 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-3xl flex items-center justify-center text-white text-4xl shadow-lg shadow-indigo-200">
                                <i class="fa-solid fa-shield-cat"></i>
                            </div>
                            <div>
                                <h2 class="text-4xl font-extrabold text-gray-900 tracking-tight">${app.getTxt('parent_dash')}</h2>
                                <p class="text-lg text-gray-500 mt-1">${app.getTxt('monitor')}</p>
                            </div>
                        </div>

                        <!-- Stats Overview -->
                        <div class="grid md:grid-cols-3 gap-6 mb-12">
                            <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4">
                                <div class="w-12 h-12 rounded-2xl bg-blue-50 text-blue-600 flex items-center justify-center text-xl"><i class="fa-solid fa-layer-group"></i></div>
                                <div>
                                    <div class="text-gray-400 text-xs font-bold uppercase tracking-wider">${app.getTxt('levels_unlocked')}</div>
                                    <div class="text-3xl font-extrabold text-gray-900">${store.user.currentLevel}/50</div>
                                </div>
                            </div>
                            <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4">
                                <div class="w-12 h-12 rounded-2xl bg-purple-50 text-purple-600 flex items-center justify-center text-xl"><i class="fa-solid fa-crown"></i></div>
                                <div>
                                    <div class="text-gray-400 text-xs font-bold uppercase tracking-wider">${app.getTxt('plan_status')}</div>
                                    <div class="text-3xl font-extrabold text-green-600">UNLOCKED</div>
                                </div>
                            </div>
                        </div>

                        <!-- SUBSCRIPTION PLANS -->
                        <div class="relative">
                             <div class="relative flex justify-center mb-10">
                                <span class="bg-indigo-50 px-6 py-2 rounded-full text-sm text-indigo-700 font-bold uppercase tracking-widest border border-indigo-200">Full Access Unlocked üéâ</span>
                            </div>
                        </div>
                        
                        <div class="bg-white p-8 rounded-3xl border border-gray-200 text-center">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Reset Passcode</h3>
                            <button onclick="store.user.parentPasscode=null; store.save(); alert('Passcode Reset. You can create a new one next time.'); router.navigate('dashboard')" class="bg-red-50 text-red-600 px-6 py-3 rounded-xl font-bold hover:bg-red-100 transition">Reset Parent Passcode</button>
                        </div>
                    </div>
                `;
            },
            
            renderArcade(c) {
                c.innerHTML = `<div class="p-10 text-center pt-32 animate-fade-in"><i class="fa-solid fa-gamepad text-6xl text-indigo-200 mb-4 animate-bounce"></i><h2 class="text-2xl font-bold text-gray-400">${app.getTxt('arcade')} - Coming Soon</h2></div>`;
            },
            
            renderProfile(c) {
                c.innerHTML = `<div class="p-10 text-center animate-fade-in"><div class="w-32 h-32 bg-indigo-100 rounded-full mx-auto mb-6 flex items-center justify-center text-5xl shadow-lg border-4 border-white relative">üë®‚ÄçüöÄ</div><h2 class="text-3xl font-extrabold text-gray-800 mb-2">${store.user.name}</h2><span class="bg-indigo-100 text-indigo-600 px-4 py-1 rounded-full text-sm font-bold">${store.user.ageGroup ? store.user.ageGroup + ' Years Old' : 'Young Coder'}</span></div>`;
            }
        };

        const payment = {
            pay(amt, desc) {
                alert("All Levels are currently unlocked for free!");
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            store.init();
            document.getElementById('onboarding-form').addEventListener('submit', app.completeOnboarding);
            window.router = router;
            if(store.user.name) router.navigate('dashboard');
        });

    </script>
</body>
</html>
